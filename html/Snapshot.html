<!-- start content -->
			<p><b>Block:</b> Snapshot (<code>snapshot</code>)<br />
<b>Block Author</b>: Andrew Martens<br />
<b>Document Author</b>: Andrew Martens<br />
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Mask_Parameters"><span class="tocnumber">2</span> <span class="toctext">Mask Parameters</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Ports"><span class="tocnumber">3</span> <span class="toctext">Ports</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Software_interface"><span class="tocnumber">4</span> <span class="toctext">Software interface</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Usage"><span class="tocnumber">5.1</span> <span class="toctext">Usage</span></a></li>
</ul>
</li>
</ul>
</td></tr></table><script>if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<h2> <span class="mw-headline" id="Summary"> Summary </span></h2>
<p>The snapshot block is configurable block for capturing blocks of data with a standard interface supporting generic software drivers. 
It combines functionality from (and deprecates) the snap, sc, snap_64 and snap_circ blocks.
</p>
<h2> <span class="mw-headline" id="Mask_Parameters"> Mask Parameters </span></h2>
<table width="1000" border="1" cellpadding="3">
<tr>
<th> Parameter
</th><th> Variable
</th><th> Description
</th></tr>
<tr>
<td> Storage medium
</td><td> storage
</td><td> Specifies whether to store the data in BRAM or DRAM
</td></tr>
<tr>
<td> DRAM dimm
</td><td> dram_dimm
</td><td> Specifies which dimm to use if using DRAM as storage medium.
</td></tr>
<tr>
<td> DRAM clock rate
</td><td> dram_clock
</td><td> Specifies the DRAM controller clock rate if using DRAM as a storage medium.
</td></tr>
<tr>
<td> No. of Samples (<span class="texhtml">2<sup>?</sup></span>)
</td><td> nsamples
</td><td> Specifies the maximum depth of the data storage buffer
</td></tr>
<tr>
<td> Data width
</td><td> data_width
</td><td> The bit width of the input data
</td></tr>
<tr>
<td> Start delay support
</td><td> offset
</td><td> Option to support inserting a programmable number of samples between the trigger for the start of capture, and data capture itself.
</td></tr>
<tr>
<td> Circular capture support
</td><td> circap
</td><td> Option to support continual capture until a signal to stop is received.
</td></tr>
<tr>
<td> Extra value capture support
</td><td> value
</td><td> Option to support the capture of a value to a register as the first data item is captured.
</td></tr>
<tr>
<td> Use DSP48s to implement counters
</td><td> use_dsp48
</td><td> Option to use DSP48s to implement various internal counters to save logic.
</td></tr>
</table>
<h2> <span class="mw-headline" id="Ports"> Ports </span></h2>
<table width="1000" border="1" cellpadding="3">
<tr>
<th> Port
</th><th> Dir
</th><th> Data Type
</th><th> Description
</th></tr>
<tr>
<td> din
</td><td> IN
</td><td> unsigned_8_0 OR unsigned_16_0 OR unsigned_32_0 OR unsigned_64_0 OR unsigned_128_0
</td><td> The data to be captured. Data is stored with oldest data in the lowest addresses and in little endian format.
</td></tr>
<tr>
<td> we
</td><td> IN
</td><td> boolean
</td><td> After a trigger is begun, enables a write to the data buffer.
</td></tr>
<tr>
<td> trig
</td><td> IN
</td><td> boolean
</td><td> When high, triggers the beginning of a data capture. Thereafter, every enabled data is written to the data buffer.
<p>If offset capture is enabled, capture can be delayed by a configurable number of samples after the trigger. If circular
capture is enabled, capture continues until the input to the stop port goes high.
</p>
</td></tr>
<tr>
<td> stop
</td><td> IN
</td><td> boolean
</td><td> Triggers the end of data capture when in circular capture mode.
</td></tr>
<tr>
<td> vin
</td><td> IN
</td><td> unsigned_32_0
</td><td> When extra value capture is enabled the value on this port is captured on the same sample as the first data item captured.
</td></tr>
<tr>
<td> ready
</td><td> OUT
</td><td> boolean
</td><td> When using DRAM as a storage buffer, signals that the DRAM controller has finished calibration and is ready to receive data.
</td></tr>
</table>
<h2> <span class="mw-headline" id="Software_interface"> Software interface </span></h2>
<table width="1000" border="1" cellpadding="3">
<tr>
<th> Name
</th><th> Dir
</th><th> Data Type
</th><th> Usage
</th></tr>
<tr>
<td> ctrl
</td><td> Write
</td><td> unsigned_32_0
</td><td>
</td></tr>
<tr>
<td> trig_offset
</td><td> Write
</td><td> unsigned_32_0
</td><td>
</td></tr>
<tr>
<td> val
</td><td> Read
</td><td> unsigned_32_0
</td><td>
</td></tr>
<tr>
<td> status
</td><td> Read
</td><td> unsigned_32_0
</td><td>
</td></tr>
<tr>
<td> tr_en_cnt
</td><td> Read
</td><td> unsigned_32_0
</td><td>
</td></tr>
<tr>
<td> bram
</td><td> Read
</td><td> unsigned_32_0
</td><td>
</td></tr>
<tr>
<td> dram
</td><td> Read
</td><td> unsigned_32_0
</td><td>
</td></tr>
</table>
<h2> <span class="mw-headline" id="Description"> Description </span></h2>
<h3> <span class="mw-headline" id="Usage"> Usage </span></h3>
<p>Under TinySH/BORPH, this device will have 3 sub-devices: <code>ctrl</code>, <code>bram</code>, and <code>addr</code>. <code>ctrl</code> is an input register. Bit 0, when driven from low to high, enables a trigger/data capture to occur. Bit 1, when high, overrides <code>trig</code> to trigger instantly. Bit 2, when high, overrides <code>we</code> to always write data to bram. <code>addr</code> is an output register and records the last address of <code>bram</code> to which data was written. <code>bram</code> is a 32 bit wide Shared BRAM of the depth specified in <code>Parameters</code>.
</p>